<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#0033cc" />
<title>CALCUIASA</title>
<link rel="manifest" href="manifest.json" />
<style>
  body {
    margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f4ff; color: #0033cc;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    min-height: 100vh;
  }
  header {
    background: #0033cc; color: white; width: 100%; padding: 1em 0;
    font-size: 2em; font-weight: 700; text-align: center;
    box-shadow: 0 3px 10px rgba(0,0,0,0.3);
    display: flex; align-items: center; justify-content: center;
    gap: 1em;
  }
  header img {
    height: 40px;
    width: auto;
  }
  #calculator {
    background: white; border-radius: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    width: 340px; max-width: 95vw;
    padding: 25px;
    display: grid; grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    margin-top: 25px;
  }
  #display {
    grid-column: span 4;
    background: #dbe9ff;
    border-radius: 15px;
    height: 70px;
    text-align: right;
    font-size: 2.8em;
    font-weight: 600;
    padding: 15px 20px;
    overflow-wrap: break-word;
    user-select: none;
  }
  button {
    background: #0033cc; color: white; font-size: 1.4em;
    border: none; border-radius: 12px;
    padding: 18px 0;
    cursor: pointer;
    box-shadow: 0 6px 15px rgba(0,51,204,0.5);
    transition: background-color 0.2s ease, transform 0.1s ease;
    user-select: none;
  }
  button:active {
    background-color: #002299;
    transform: scale(0.95);
  }
  button.operator {
    background: #d32f2f;
  }
  button.operator:active {
    background-color: #9a1c1c;
  }
  button.wide {
    grid-column: span 2;
  }
</style>
</head>
<body>
<header>
  <!-- Aquí irá el logo cuando lo tengas -->
  <div>CALCUIASA</div>
</header>
<div id="calculator" role="application" aria-label="Calculadora CALCUIASA">
  <div id="display" aria-live="polite" aria-atomic="true" role="textbox">0</div>
  <button class="operator" aria-label="Limpiar" data-action="clear">C</button>
  <button class="operator" aria-label="Borrar" data-action="backspace">⌫</button>
  <button class="operator" aria-label="Porcentaje" data-action="percent">%</button>
  <button class="operator" aria-label="Dividir" data-action="divide">÷</button>

  <button aria-label="7" data-digit="7">7</button>
  <button aria-label="8" data-digit="8">8</button>
  <button aria-label="9" data-digit="9">9</button>
  <button class="operator" aria-label="Multiplicar" data-action="multiply">×</button>

  <button aria-label="4" data-digit="4">4</button>
  <button aria-label="5" data-digit="5">5</button>
  <button aria-label="6" data-digit="6">6</button>
  <button class="operator" aria-label="Restar" data-action="subtract">−</button>

  <button aria-label="1" data-digit="1">1</button>
  <button aria-label="2" data-digit="2">2</button>
  <button aria-label="3" data-digit="3">3</button>
  <button class="operator" aria-label="Sumar" data-action="add">+</button>

  <button aria-label="0" data-digit="0" class="wide">0</button>
  <button aria-label="Punto decimal" data-digit=".">.</button>
  <button class="operator" aria-label="Igual" data-action="equals">=</button>
</div>

<script>
(() => {
  const display = document.getElementById('display');
  let current = '';
  let previous = null;
  let operator = null;
  let resetNext = false;

  function updateDisplay(value) {
    display.textContent = value;
  }

  function calculate() {
    if (previous === null || operator === null) return;
    let a = parseFloat(previous);
    let b = parseFloat(current);
    if (isNaN(a) || isNaN(b)) return;
    let result;
    switch(operator) {
      case 'add': result = a + b; break;
      case 'subtract': result = a - b; break;
      case 'multiply': result = a * b; break;
      case 'divide': result = b === 0 ? 'Error' : a / b; break;
      case 'percent': result = a * b / 100; break;
      default: return;
    }
    current = result.toString();
    previous = null;
    operator = null;
    updateDisplay(current);
  }

  function clearAll() {
    current = '';
    previous = null;
    operator = null;
    updateDisplay('0');
  }

  function backspace() {
    if(resetNext) return;
    current = current.slice(0, -1);
    if (current === '') current = '0';
    updateDisplay(current);
  }

  function appendDigit(d) {
    if(resetNext) {
      current = '';
      resetNext = false;
    }
    if (d === '.' && current.includes('.')) return;
    if (current === '0' && d !== '.') current = '';
    current += d;
    updateDisplay(current);
  }

  function handleOperator(op) {
    if (current === '') return;
    if (previous !== null && operator !== null && !resetNext) {
      calculate();
    }
    previous = current;
    operator = op;
    resetNext = true;
  }

  document.getElementById('calculator').addEventListener('click', e => {
    const target = e.target;
    if (target.tagName !== 'BUTTON') return;

    if (target.hasAttribute('data-digit')) {
      appendDigit(target.getAttribute('data-digit'));
    } else if (target.hasAttribute('data-action')) {
      switch(target.getAttribute('data-action')) {
        case 'clear': clearAll(); break;
        case 'backspace': backspace(); break;
        case 'add': handleOperator('add'); break;
        case 'subtract': handleOperator('subtract'); break;
        case 'multiply': handleOperator('multiply'); break;
        case 'divide': handleOperator('divide'); break;
        case 'percent': handleOperator('percent'); break;
        case 'equals': calculate(); break;
      }
    }
  });

  clearAll();
})();
</script>
</body>
</html>
